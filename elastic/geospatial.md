    library(elastic)
    library(dplyr)
    library(leaflet)

connect
-------

    elastic::connect()

    #> transport:  http 
    #> host:       127.0.0.1 
    #> port:       9200 
    #> path:       NULL 
    #> username:   NULL 
    #> password:   <secret> 
    #> errors:     simple 
    #> headers (names):  NULL

function to make leaflet viz
----------------------------

    make_viz <- function(x) {
      leaflet() %>% 
        addProviderTiles("Stamen.Toner") %>% 
        addMarkers(data = x) 
    }

    make_df <- function(x) {
      tbl_df(do.call(rbind, lapply(x$hits$hits, function(x) data.frame(x$`_source`$location)))) 
    }

all the data
------------

    out <- Search('gbifgeopoint', size = 1000)
    out$hits$total

    #> [1] 600

    (dat <- make_df(out))

    #> # A tibble: 600 x 2
    #>         lon      lat
    #> *     <dbl>    <dbl>
    #> 1   2.97260 51.13451
    #> 2   2.93852 51.08603
    #> 3   2.93760 51.08666
    #> 4   2.85835 51.02540
    #> 5   2.94271 51.08526
    #> 6   2.93141 51.23301
    #> 7   2.93012 51.23349
    #> 8  12.37820 58.28100
    #> 9  13.41860 55.67690
    #> 10 20.25920 63.82150
    #> # ... with 590 more rows

### visualize

bounding box to define extent

    bbox <- '{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"color":"blue"},"geometry":{"type":"Polygon","coordinates":[[[-4,31],[-4,69],[29,69],[29,31],[-4,31]]]}}]}'

visualize just data

    make_viz(dat)

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-5897">{"x":{"calls":[{"method":"addProviderTiles","args":["Stamen.Toner",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[[51.13451,51.08603,51.08666,51.0254,51.08526,51.23301,51.23349,58.281,55.6769,63.8215,57.7197,59.9241,59.8146,59.2667,59.543,63.8316,58.755,65.5548,56.5807,65.536,58.3872,62.8007,55.6978,58.5023,57.99,57.7157,56.1606,60.617,58.9024,50.57702,50.4065,51.18375,56.73616,50.33438,50.85697,48.94891,58.7554,64.7,64,63.1,61.2,61,60.1,61.4,66.4,60.2,60.2,63.8,60.4,60.5,56.2687,56.176,59.3766,55.7283,57.5271,57.6581,62.3878,55.5458,56.1942,56.2648,59.2467,57.7233,55.6324,57.7393,57.1307,63.194,58.306,59.8053,60.0605,59.5653,58.2228,57.7049,58.3345,57.7387,58.8659,59.4762,56.7215,59.8053,57.7809,59.6654,59.2733,56.195,57.7105,59.847,59.8622,56.1942,59.4095,59.2905,61.7007,59.2888,62.4633,57.9052,59.3268,62.3121,59.7566,59.2597,58.4787,58.662,58.9336,63.8615,57.8925,59.46,55.3757,58.5396,59.4923,57.6538,58.7579,59.3339,58.6786,57.5946,57.7601,60.8102,56.7037,51.21396,51.21672,51.21409,50.36873,51.19674,50.98989,58.4327,56.6683,56.1528,59.9171,63.8844,57.6699,59.2649,66.5964,55.6724,55.6073,55.5458,58.3301,58.3886,58.1893,57.7795,59.8448,58.9811,58.2096,59.3971,59.3725,60.3295,58.9024,50.323,50.55233,49.37392,50.30291,49.01533,52.55914,49.3508,59.272,55.6777,64.7,61.7,61.2,62,61.8,60.7,60.9,63.2,60.9,65.9,65.9,61.5,61.3,61.5,60.8,57.6812,63.8037,59.4648,56.2441,58.6381,58.6651,59.3558,56.0418,59.6279,57.6934,57.7413,55.6106,57.6953,58.306,57.8406,59.8543,57.6444,60.0836,59.3618,57.7416,58.7633,59.9413,59.5496,59.6326,56.6861,56.1627,59.9136,59.2833,57.7622,59.1943,55.6765,60.6736,59.729,59.3552,57.8259,57.9086,60.6736,58.3977,57.9667,57.8956,60.4627,58.759,57.7498,55.5623,57.969,58.5557,59.3517,60.0447,58.4,57.7796,56.6467,57.6479,60.0997,59.2733,55.5945,55.671,56.2851,58.5662,59.8032,58.7454,63.5358,56.7701,56.317,55.6172,59.125,51.15793,51.16502,51.23329,51.02456,51.0255,51.13017,59.3406,57.9355,58.4161,56.6675,58.3725,58.8958,58.5346,60.504,57.6869,56.9555,57.6487,58.8992,57.7686,57.3055,56.1965,49.79703,53.62209,51.91853,49.49161,60.2,56.651,59.0016,55.8023,55.5979,60.1,63,60.6,63.2,61,62.7,64.1,60.4,60.9,60.4,60.4,63.2,60.5,63.5,64.2,59.8,60.2,60.1,57.9376,57.9125,56.2215,56.1308,55.6765,55.9223,63.7081,57.7601,64.6871,58.9336,59.3717,55.3933,59.6208,56.35,56.2233,63.0633,56.992,56.8891,60.77,55.8968,55.9897,55.7489,57.7811,65.8186,59.0598,58.0959,58.7554,56.4706,59.2041,56.6448,60.7922,57.6555,59.8095,59.3725,58.1741,58.269,58.6347,57.9363,60.6983,60.5938,57.7105,58.6236,58.2916,59.254,59.2857,59.6031,60.6678,57.9221,57.9325,55.5597,59.8437,59.2935,60.6605,60.7391,58.9336,59.4139,59.4051,59.7894,59.8375,59.5788,56.6765,60.4655,60.5862,57.6634,58.9001,57.6336,65.6802,57.9823,59.0777,59.2452,55.7052,59.2264,65.2727,56.6062,57.6239,56.4779,57.7049,56.608,59.3725,55.5333,51.15274,51.21639,51.02467,51.02468,51.08376,63.8421,58.9811,56.49,59.0713,59.2166,60.9111,59.7912,65.5697,57.7008,55.571,57.6063,56.5286,57.3663,57.721,60.6735,59.2634,57.9725,55.9223,59.3259,58.1361,58.7135,53.16262,51.62402,50.72377,52.45855,31.29493,52.54577,60.5,65,60.5,60.3,64.8,64.3,60.2,65,61.5,64.5,60.8,61.3,67.7605,58.9336,59.752,56.4273,56.3393,55.8546,55.9058,56.54,59.3258,57.6336,59.4568,57.6777,56.7583,57.7358,56.2036,56.3416,57.7774,57.7447,56.3548,60.6884,57.655,56.9052,55.6541,59.3725,58.7974,58.9056,55.7489,59.2151,56.3229,55.5582,57.6342,60.0044,60.1871,59.0723,56.876,66.6059,56.1469,58.4952,65.8802,58.9336,57.0275,59.274,56.5906,65.2727,59.8053,59.4243,59.3725,57.4373,57.7796,58.7696,59.8138,55.4044,58.2069,57.7064,59.0808,55.3942,59.1609,58.547,56.608,58.3562,57.7801,59.2869,56.7055,55.7842,58.9336,57.7039,57.7416,59.671,59.2705,57.6703,59.0515,51.22471,50.36614,51.0246,51.08631,57.2358,65.6403,60.0145,59.7421,63.5688,66.4867,59.7975,57.2493,57.5767,57.1307,56.1776,59.1169,57.8669,59.2681,59.8887,59.3377,59.1147,57.6874,59.8271,58.0288,59.2774,51.62494,50.37828,50.40632,49.01533,49.43728,53.89132,48.79044,50.28015,56.5906,55.8391,60.4,61,64.2,64.2,60.5,69,60.4,60.2,60.8,62.8,60.4,60.2,63.4,65.8,64.8,62.2,61.6,64.8,60.8,63.4,60.8,62.6,59.8,61.5,63.1,60.2,60.9,60.1,60.5,56.195,58.306,57.6953,59.005,56.425,58.4212,58.6338,55.4741,59.2722,62.4633,55.9223,57.5665,57.8355,56.4658,56.176,55.6818,55.5582,59.2778,57.6846,56.0834,59.8236,55.6904,58.3826,57.0293,58.5333,55.4175,55.38,57.8571,59.4568,56.2851,59.368,59.2794,56.9147,55.7311,57.3086,58.5235,59.3914,60.6012,58.3436,57.7736,57.8971,59.4623,57.9578,58.581,59.3241,57.9603,56.608,59.3412,57.4647,57.9578,57.6812,59.4243,63.8552,56.4279,59.8375,59.2999,59.9874,57.721,56.2283,58.0198,57.3071,56.5293,57.6336],[2.9726,2.93852,2.9376,2.85835,2.94271,2.93141,2.93012,12.3782,13.4186,20.2592,11.6341,17.3365,17.6428,17.9133,18.1691,20.2395,17.864,17.8506,16.6384,17.5083,13.4132,13.0709,13.4267,13.7762,14.9239,11.9174,15.4839,15.6069,16.4785,7.15663,8.96661,6.74515,8.23666,8.53929,6.14764,9.29086,17.0123,24.5,23.5,23.6,24,22.2,23,26.4,23.8,24.9,19.6,23.1,22.5,24.2,16.4041,12.5618,13.5001,13.1549,11.9267,12.0594,13.9472,13.0966,16.399,12.8467,17.9591,16.5405,13.0502,12.0211,12.238,14.6798,12.2801,17.6634,15.7877,17.8987,11.9152,11.9984,11.7097,12.1392,16.6073,16.8529,13.1311,17.6634,12.3039,17.3827,15.2723,16.4004,11.6332,17.6565,17.6576,16.399,13.5932,17.8186,17.52,17.8108,17.4606,14.0861,18.8703,17.1727,17.1247,15.2494,16.3233,17.13,17.9545,15.6051,11.6733,16.0704,13.0979,13.9029,16.0545,12.8808,17.0046,17.2587,17.0934,11.9205,11.6093,17.241,16.345,2.87053,2.87409,2.86805,3.02608,2.83178,2.8549,12.6393,12.7958,15.3285,12.2509,20.2988,11.8497,15.1415,19.8453,13.0764,12.9768,13.0966,11.9034,15.412,13.9707,14.131,17.7013,14.0643,16.5936,17.9373,17.9871,12.6913,16.4785,8.56359,8.83969,7.04092,8.62292,8.40441,13.54983,8.63868,14.396,14.2271,24.5,27.3,26.2,29,25.3,26,25.6,23,25.6,29.4,29,23.2,22.9,23.7,23.6,11.9542,20.2614,17.9217,16.4645,17.0363,13.1,17.0144,12.7193,17.87,18.3556,18.4069,13.0094,12.0537,12.2801,13.2862,13.182,18.2943,16.5954,17.8221,11.9256,17.0914,13.0985,18.1612,17.0586,16.3342,14.7465,17.576,15.2543,11.9415,15.4232,13.417,17.1641,17.7178,17.0413,13.1644,14.1228,17.1641,15.6337,12.7278,16.3986,15.3994,17.001,12.1787,13.855,14.7465,13.9543,17.8113,18.8421,14.9223,14.1979,16.4767,12.0303,18.8089,15.2723,14.3148,13.6224,16.4079,11.9288,17.1874,17.0259,19.7681,16.3767,16.5313,13.6531,18.3523,2.90821,2.83704,2.93086,2.85611,2.85903,3.10096,17.88,12.5294,15.2288,16.294,15.6249,17.5368,14.5072,15.3991,11.9409,13.5288,18.5552,17.9513,11.9806,18.2632,15.435,8.25646,10.71133,10.45102,10.95524,22.4,16.4844,17.7045,13.367,13.3974,27,24.9,22.2,22.4,26,27.8,23.4,22.5,26,22.3,22.3,24,25.1,22.5,24.4,21.6,23.9,19.9,12.5844,12.559,12.7826,15.6218,13.417,14.3262,20.4288,11.6093,20.5996,17.9545,17.9677,13.0009,17.0636,15.1405,12.7158,17.7513,18.3522,14.8108,15.1223,12.8061,12.7458,13.3504,11.6077,15.0827,18.0465,11.8185,17.0123,12.7348,17.8855,16.6734,17.3463,12.0414,17.6668,17.9871,13.5495,12.2574,15.3188,12.5025,17.1593,17.5636,11.6332,13.0236,12.3031,15.2621,15.1516,16.5711,17.1977,12.4834,12.5148,12.9036,17.6673,17.9077,17.1645,17.32,17.9545,18.0914,17.9045,17.649,13.1411,17.9124,16.3485,18.4083,15.7227,12.1024,17.938,11.9095,21.805,11.7948,16.3716,15.1875,13.237,18.2357,18.8336,12.9152,11.9277,16.4217,11.9749,16.432,17.9871,13.193,2.92585,2.87274,2.85662,2.85645,2.94404,20.3246,14.0643,13.6316,17.972,18.0627,16.3744,12.613,22.2435,11.791,13.5107,18.2473,16.388,17.0661,11.9903,17.1242,18.2015,14.9603,14.3262,14.8286,11.7958,16.9901,12.78225,7.55114,6.95759,10.17594,-3.97784,13.54717,21.9,25.2,25,24.6,25.2,24.6,19.6,25.4,24.3,26.4,23.6,24.61,17.7186,17.9545,19.0728,12.6281,12.7396,13.0839,12.8053,14.813,17.7134,11.9095,17.9054,18.4221,13.9846,11.9272,12.8391,16.5304,14.136,12.1715,16.4411,17.1796,12.0805,12.5594,13.0719,17.9871,16.7347,11.9317,13.3504,15.4177,16.5428,14.3574,11.9112,15.8092,16.1265,15.8661,16.6631,19.8283,13.7941,15.5109,21.6728,17.9545,14.741,15.0435,16.3985,18.8336,17.6634,17.8787,17.9871,14.1231,14.1979,17.4722,17.7091,12.9396,15.6657,11.812,16.3276,13.6023,15.3069,15.0717,16.432,13.9249,16.2703,16.4717,13.0934,13.2463,17.9545,11.7787,11.9256,12.5141,15.2608,18.3284,17.865,3.0293,3.02442,2.85672,2.9361,15.1473,22.2382,14.7328,17.2959,19.4965,20.6037,17.6502,12.1254,11.928,12.238,12.555,17.7832,11.9724,18.0699,16.2914,17.9876,17.9903,11.795,17.6677,14.4563,17.7051,7.21848,9.11676,8.97034,8.40441,8.5215,10.68014,9.48923,9.11274,16.4137,13.3008,22.3,23.5,27.8,27.8,22.1,27,22.6,25.1,23.8,25.4,22.5,24.8,25.3,24.2,24.6,25.8,21.4,25.6,25.4,21.4,27.5,27.6,21.4,21.8,21.7,24.9,28.3,24.4,22.5,16.4004,12.2801,12.0537,18.2873,12.6184,14.1484,14.5916,14.2785,15.1738,17.4606,14.3262,12.0869,12.2845,13.6086,12.5618,13.4025,14.3574,15.1456,12.7578,12.697,17.8176,13.4936,15.6536,12.3035,14.0254,12.8553,14.0556,11.7049,17.9054,16.3963,16.4924,15.1759,14.0144,13.0241,15.8513,13.8909,17.8925,15.66,11.9048,14.1881,14.0468,17.8601,12.5755,16.1775,18.2603,12.4458,16.432,18.1878,12.6346,12.5755,11.9542,17.8787,20.3394,12.8449,13.1411,15.4646,18.3379,11.9903,12.6727,11.595,14.0053,16.3732,11.9095],null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null]}],"limits":{"lat":[31.29493,69],"lng":[-3.97784,29.4]}},"evals":[],"jsHooks":[]}</script>
<!--/html_preserve-->
visualize data and bounding extent

    make_viz(dat) %>% addGeoJSON(geojson = bbox)

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-3800">{"x":{"calls":[{"method":"addProviderTiles","args":["Stamen.Toner",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[[51.13451,51.08603,51.08666,51.0254,51.08526,51.23301,51.23349,58.281,55.6769,63.8215,57.7197,59.9241,59.8146,59.2667,59.543,63.8316,58.755,65.5548,56.5807,65.536,58.3872,62.8007,55.6978,58.5023,57.99,57.7157,56.1606,60.617,58.9024,50.57702,50.4065,51.18375,56.73616,50.33438,50.85697,48.94891,58.7554,64.7,64,63.1,61.2,61,60.1,61.4,66.4,60.2,60.2,63.8,60.4,60.5,56.2687,56.176,59.3766,55.7283,57.5271,57.6581,62.3878,55.5458,56.1942,56.2648,59.2467,57.7233,55.6324,57.7393,57.1307,63.194,58.306,59.8053,60.0605,59.5653,58.2228,57.7049,58.3345,57.7387,58.8659,59.4762,56.7215,59.8053,57.7809,59.6654,59.2733,56.195,57.7105,59.847,59.8622,56.1942,59.4095,59.2905,61.7007,59.2888,62.4633,57.9052,59.3268,62.3121,59.7566,59.2597,58.4787,58.662,58.9336,63.8615,57.8925,59.46,55.3757,58.5396,59.4923,57.6538,58.7579,59.3339,58.6786,57.5946,57.7601,60.8102,56.7037,51.21396,51.21672,51.21409,50.36873,51.19674,50.98989,58.4327,56.6683,56.1528,59.9171,63.8844,57.6699,59.2649,66.5964,55.6724,55.6073,55.5458,58.3301,58.3886,58.1893,57.7795,59.8448,58.9811,58.2096,59.3971,59.3725,60.3295,58.9024,50.323,50.55233,49.37392,50.30291,49.01533,52.55914,49.3508,59.272,55.6777,64.7,61.7,61.2,62,61.8,60.7,60.9,63.2,60.9,65.9,65.9,61.5,61.3,61.5,60.8,57.6812,63.8037,59.4648,56.2441,58.6381,58.6651,59.3558,56.0418,59.6279,57.6934,57.7413,55.6106,57.6953,58.306,57.8406,59.8543,57.6444,60.0836,59.3618,57.7416,58.7633,59.9413,59.5496,59.6326,56.6861,56.1627,59.9136,59.2833,57.7622,59.1943,55.6765,60.6736,59.729,59.3552,57.8259,57.9086,60.6736,58.3977,57.9667,57.8956,60.4627,58.759,57.7498,55.5623,57.969,58.5557,59.3517,60.0447,58.4,57.7796,56.6467,57.6479,60.0997,59.2733,55.5945,55.671,56.2851,58.5662,59.8032,58.7454,63.5358,56.7701,56.317,55.6172,59.125,51.15793,51.16502,51.23329,51.02456,51.0255,51.13017,59.3406,57.9355,58.4161,56.6675,58.3725,58.8958,58.5346,60.504,57.6869,56.9555,57.6487,58.8992,57.7686,57.3055,56.1965,49.79703,53.62209,51.91853,49.49161,60.2,56.651,59.0016,55.8023,55.5979,60.1,63,60.6,63.2,61,62.7,64.1,60.4,60.9,60.4,60.4,63.2,60.5,63.5,64.2,59.8,60.2,60.1,57.9376,57.9125,56.2215,56.1308,55.6765,55.9223,63.7081,57.7601,64.6871,58.9336,59.3717,55.3933,59.6208,56.35,56.2233,63.0633,56.992,56.8891,60.77,55.8968,55.9897,55.7489,57.7811,65.8186,59.0598,58.0959,58.7554,56.4706,59.2041,56.6448,60.7922,57.6555,59.8095,59.3725,58.1741,58.269,58.6347,57.9363,60.6983,60.5938,57.7105,58.6236,58.2916,59.254,59.2857,59.6031,60.6678,57.9221,57.9325,55.5597,59.8437,59.2935,60.6605,60.7391,58.9336,59.4139,59.4051,59.7894,59.8375,59.5788,56.6765,60.4655,60.5862,57.6634,58.9001,57.6336,65.6802,57.9823,59.0777,59.2452,55.7052,59.2264,65.2727,56.6062,57.6239,56.4779,57.7049,56.608,59.3725,55.5333,51.15274,51.21639,51.02467,51.02468,51.08376,63.8421,58.9811,56.49,59.0713,59.2166,60.9111,59.7912,65.5697,57.7008,55.571,57.6063,56.5286,57.3663,57.721,60.6735,59.2634,57.9725,55.9223,59.3259,58.1361,58.7135,53.16262,51.62402,50.72377,52.45855,31.29493,52.54577,60.5,65,60.5,60.3,64.8,64.3,60.2,65,61.5,64.5,60.8,61.3,67.7605,58.9336,59.752,56.4273,56.3393,55.8546,55.9058,56.54,59.3258,57.6336,59.4568,57.6777,56.7583,57.7358,56.2036,56.3416,57.7774,57.7447,56.3548,60.6884,57.655,56.9052,55.6541,59.3725,58.7974,58.9056,55.7489,59.2151,56.3229,55.5582,57.6342,60.0044,60.1871,59.0723,56.876,66.6059,56.1469,58.4952,65.8802,58.9336,57.0275,59.274,56.5906,65.2727,59.8053,59.4243,59.3725,57.4373,57.7796,58.7696,59.8138,55.4044,58.2069,57.7064,59.0808,55.3942,59.1609,58.547,56.608,58.3562,57.7801,59.2869,56.7055,55.7842,58.9336,57.7039,57.7416,59.671,59.2705,57.6703,59.0515,51.22471,50.36614,51.0246,51.08631,57.2358,65.6403,60.0145,59.7421,63.5688,66.4867,59.7975,57.2493,57.5767,57.1307,56.1776,59.1169,57.8669,59.2681,59.8887,59.3377,59.1147,57.6874,59.8271,58.0288,59.2774,51.62494,50.37828,50.40632,49.01533,49.43728,53.89132,48.79044,50.28015,56.5906,55.8391,60.4,61,64.2,64.2,60.5,69,60.4,60.2,60.8,62.8,60.4,60.2,63.4,65.8,64.8,62.2,61.6,64.8,60.8,63.4,60.8,62.6,59.8,61.5,63.1,60.2,60.9,60.1,60.5,56.195,58.306,57.6953,59.005,56.425,58.4212,58.6338,55.4741,59.2722,62.4633,55.9223,57.5665,57.8355,56.4658,56.176,55.6818,55.5582,59.2778,57.6846,56.0834,59.8236,55.6904,58.3826,57.0293,58.5333,55.4175,55.38,57.8571,59.4568,56.2851,59.368,59.2794,56.9147,55.7311,57.3086,58.5235,59.3914,60.6012,58.3436,57.7736,57.8971,59.4623,57.9578,58.581,59.3241,57.9603,56.608,59.3412,57.4647,57.9578,57.6812,59.4243,63.8552,56.4279,59.8375,59.2999,59.9874,57.721,56.2283,58.0198,57.3071,56.5293,57.6336],[2.9726,2.93852,2.9376,2.85835,2.94271,2.93141,2.93012,12.3782,13.4186,20.2592,11.6341,17.3365,17.6428,17.9133,18.1691,20.2395,17.864,17.8506,16.6384,17.5083,13.4132,13.0709,13.4267,13.7762,14.9239,11.9174,15.4839,15.6069,16.4785,7.15663,8.96661,6.74515,8.23666,8.53929,6.14764,9.29086,17.0123,24.5,23.5,23.6,24,22.2,23,26.4,23.8,24.9,19.6,23.1,22.5,24.2,16.4041,12.5618,13.5001,13.1549,11.9267,12.0594,13.9472,13.0966,16.399,12.8467,17.9591,16.5405,13.0502,12.0211,12.238,14.6798,12.2801,17.6634,15.7877,17.8987,11.9152,11.9984,11.7097,12.1392,16.6073,16.8529,13.1311,17.6634,12.3039,17.3827,15.2723,16.4004,11.6332,17.6565,17.6576,16.399,13.5932,17.8186,17.52,17.8108,17.4606,14.0861,18.8703,17.1727,17.1247,15.2494,16.3233,17.13,17.9545,15.6051,11.6733,16.0704,13.0979,13.9029,16.0545,12.8808,17.0046,17.2587,17.0934,11.9205,11.6093,17.241,16.345,2.87053,2.87409,2.86805,3.02608,2.83178,2.8549,12.6393,12.7958,15.3285,12.2509,20.2988,11.8497,15.1415,19.8453,13.0764,12.9768,13.0966,11.9034,15.412,13.9707,14.131,17.7013,14.0643,16.5936,17.9373,17.9871,12.6913,16.4785,8.56359,8.83969,7.04092,8.62292,8.40441,13.54983,8.63868,14.396,14.2271,24.5,27.3,26.2,29,25.3,26,25.6,23,25.6,29.4,29,23.2,22.9,23.7,23.6,11.9542,20.2614,17.9217,16.4645,17.0363,13.1,17.0144,12.7193,17.87,18.3556,18.4069,13.0094,12.0537,12.2801,13.2862,13.182,18.2943,16.5954,17.8221,11.9256,17.0914,13.0985,18.1612,17.0586,16.3342,14.7465,17.576,15.2543,11.9415,15.4232,13.417,17.1641,17.7178,17.0413,13.1644,14.1228,17.1641,15.6337,12.7278,16.3986,15.3994,17.001,12.1787,13.855,14.7465,13.9543,17.8113,18.8421,14.9223,14.1979,16.4767,12.0303,18.8089,15.2723,14.3148,13.6224,16.4079,11.9288,17.1874,17.0259,19.7681,16.3767,16.5313,13.6531,18.3523,2.90821,2.83704,2.93086,2.85611,2.85903,3.10096,17.88,12.5294,15.2288,16.294,15.6249,17.5368,14.5072,15.3991,11.9409,13.5288,18.5552,17.9513,11.9806,18.2632,15.435,8.25646,10.71133,10.45102,10.95524,22.4,16.4844,17.7045,13.367,13.3974,27,24.9,22.2,22.4,26,27.8,23.4,22.5,26,22.3,22.3,24,25.1,22.5,24.4,21.6,23.9,19.9,12.5844,12.559,12.7826,15.6218,13.417,14.3262,20.4288,11.6093,20.5996,17.9545,17.9677,13.0009,17.0636,15.1405,12.7158,17.7513,18.3522,14.8108,15.1223,12.8061,12.7458,13.3504,11.6077,15.0827,18.0465,11.8185,17.0123,12.7348,17.8855,16.6734,17.3463,12.0414,17.6668,17.9871,13.5495,12.2574,15.3188,12.5025,17.1593,17.5636,11.6332,13.0236,12.3031,15.2621,15.1516,16.5711,17.1977,12.4834,12.5148,12.9036,17.6673,17.9077,17.1645,17.32,17.9545,18.0914,17.9045,17.649,13.1411,17.9124,16.3485,18.4083,15.7227,12.1024,17.938,11.9095,21.805,11.7948,16.3716,15.1875,13.237,18.2357,18.8336,12.9152,11.9277,16.4217,11.9749,16.432,17.9871,13.193,2.92585,2.87274,2.85662,2.85645,2.94404,20.3246,14.0643,13.6316,17.972,18.0627,16.3744,12.613,22.2435,11.791,13.5107,18.2473,16.388,17.0661,11.9903,17.1242,18.2015,14.9603,14.3262,14.8286,11.7958,16.9901,12.78225,7.55114,6.95759,10.17594,-3.97784,13.54717,21.9,25.2,25,24.6,25.2,24.6,19.6,25.4,24.3,26.4,23.6,24.61,17.7186,17.9545,19.0728,12.6281,12.7396,13.0839,12.8053,14.813,17.7134,11.9095,17.9054,18.4221,13.9846,11.9272,12.8391,16.5304,14.136,12.1715,16.4411,17.1796,12.0805,12.5594,13.0719,17.9871,16.7347,11.9317,13.3504,15.4177,16.5428,14.3574,11.9112,15.8092,16.1265,15.8661,16.6631,19.8283,13.7941,15.5109,21.6728,17.9545,14.741,15.0435,16.3985,18.8336,17.6634,17.8787,17.9871,14.1231,14.1979,17.4722,17.7091,12.9396,15.6657,11.812,16.3276,13.6023,15.3069,15.0717,16.432,13.9249,16.2703,16.4717,13.0934,13.2463,17.9545,11.7787,11.9256,12.5141,15.2608,18.3284,17.865,3.0293,3.02442,2.85672,2.9361,15.1473,22.2382,14.7328,17.2959,19.4965,20.6037,17.6502,12.1254,11.928,12.238,12.555,17.7832,11.9724,18.0699,16.2914,17.9876,17.9903,11.795,17.6677,14.4563,17.7051,7.21848,9.11676,8.97034,8.40441,8.5215,10.68014,9.48923,9.11274,16.4137,13.3008,22.3,23.5,27.8,27.8,22.1,27,22.6,25.1,23.8,25.4,22.5,24.8,25.3,24.2,24.6,25.8,21.4,25.6,25.4,21.4,27.5,27.6,21.4,21.8,21.7,24.9,28.3,24.4,22.5,16.4004,12.2801,12.0537,18.2873,12.6184,14.1484,14.5916,14.2785,15.1738,17.4606,14.3262,12.0869,12.2845,13.6086,12.5618,13.4025,14.3574,15.1456,12.7578,12.697,17.8176,13.4936,15.6536,12.3035,14.0254,12.8553,14.0556,11.7049,17.9054,16.3963,16.4924,15.1759,14.0144,13.0241,15.8513,13.8909,17.8925,15.66,11.9048,14.1881,14.0468,17.8601,12.5755,16.1775,18.2603,12.4458,16.432,18.1878,12.6346,12.5755,11.9542,17.8787,20.3394,12.8449,13.1411,15.4646,18.3379,11.9903,12.6727,11.595,14.0053,16.3732,11.9095],null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null]},{"method":"addGeoJSON","args":["{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"color\":\"blue\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[-4,31],[-4,69],[29,69],[29,31],[-4,31]]]}}]}",null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false}]}],"limits":{"lat":[31.29493,69],"lng":[-3.97784,29.4]}},"evals":[],"jsHooks":[]}</script>
<!--/html_preserve-->
Points within a bounding box
----------------------------

    body <- '{
      "query":{
        "bool" : {
          "must" : {
            "match_all" : {}
          },
          "filter":{
             "geo_bounding_box" : {
               "location" : {
                 "top_left" : {
                   "lat" : 60,
                   "lon" : 1
                 },
                 "bottom_right" : {
                   "lat" : 40,
                   "lon" : 14
                 }
               }
            }
          }
        }
      }
     }'
    out <- Search('gbifgeopoint', body = body, size = 500)
    out$hits$total

    #> [1] 225

    dat <- make_df(out)

visualize

    bbox <- '{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"color":"blue"},"geometry":{"type":"Polygon","coordinates":[[[1,40],[1,60],[14,60],[14,40],[1,40]]]}}]}'
    make_viz(dat) %>% addGeoJSON(geojson = bbox)

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-7180">{"x":{"calls":[{"method":"addProviderTiles","args":["Stamen.Toner",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[[51.13451,51.08603,51.08666,51.0254,51.08526,51.23301,51.23349,58.281,55.6769,57.7197,58.3872,55.6978,58.5023,57.7157,50.57702,50.4065,51.18375,56.73616,50.33438,50.85697,48.94891,56.176,59.3766,55.7283,57.5271,57.6581,55.5458,56.2648,55.6324,57.7393,57.1307,58.306,58.2228,57.7049,58.3345,57.7387,56.7215,57.7809,57.7105,59.4095,57.8925,55.3757,58.5396,57.6538,57.5946,57.7601,51.21396,51.21672,51.21409,50.36873,51.19674,50.98989,58.4327,56.6683,59.9171,57.6699,55.6724,55.6073,55.5458,58.3301,58.1893,50.323,50.55233,49.37392,50.30291,49.01533,52.55914,49.3508,57.6812,58.6651,56.0418,55.6106,57.6953,58.306,57.8406,59.8543,57.7416,59.9413,57.7622,55.6765,57.8259,57.9667,57.7498,55.5623,58.5557,57.6479,55.671,58.5662,55.6172,51.15793,51.16502,51.23329,51.02456,51.0255,51.13017,57.9355,57.6869,56.9555,57.7686,49.79703,53.62209,51.91853,49.49161,55.8023,55.5979,57.9376,57.9125,56.2215,55.6765,57.7601,55.3933,56.2233,55.8968,55.9897,55.7489,57.7811,58.0959,56.4706,57.6555,58.1741,58.269,57.9363,57.7105,58.6236,58.2916,57.9221,57.9325,55.5597,59.8375,57.6634,57.6336,57.9823,55.7052,56.6062,57.6239,57.7049,55.5333,51.15274,51.21639,51.02467,51.02468,51.08376,56.49,59.7912,57.7008,55.571,57.721,58.1361,53.16262,51.62402,50.72377,52.45855,52.54577,56.4273,56.3393,55.8546,55.9058,57.6336,56.7583,57.7358,56.2036,57.7447,57.655,56.9052,55.6541,58.9056,55.7489,57.6342,56.1469,55.4044,57.7064,55.3942,58.3562,56.7055,55.7842,57.7039,57.7416,59.671,51.22471,50.36614,51.0246,51.08631,57.2493,57.5767,57.1307,56.1776,57.8669,57.6874,51.62494,50.37828,50.40632,49.01533,49.43728,53.89132,48.79044,50.28015,55.8391,58.306,57.6953,56.425,57.5665,57.8355,56.4658,56.176,55.6818,57.6846,56.0834,55.6904,57.0293,55.4175,57.8571,55.7311,58.5235,58.3436,57.9578,57.9603,57.4647,57.9578,57.6812,56.4279,59.8375,57.721,56.2283,58.0198,57.6336],[2.9726,2.93852,2.9376,2.85835,2.94271,2.93141,2.93012,12.3782,13.4186,11.6341,13.4132,13.4267,13.7762,11.9174,7.15663,8.96661,6.74515,8.23666,8.53929,6.14764,9.29086,12.5618,13.5001,13.1549,11.9267,12.0594,13.0966,12.8467,13.0502,12.0211,12.238,12.2801,11.9152,11.9984,11.7097,12.1392,13.1311,12.3039,11.6332,13.5932,11.6733,13.0979,13.9029,12.8808,11.9205,11.6093,2.87053,2.87409,2.86805,3.02608,2.83178,2.8549,12.6393,12.7958,12.2509,11.8497,13.0764,12.9768,13.0966,11.9034,13.9707,8.56359,8.83969,7.04092,8.62292,8.40441,13.54983,8.63868,11.9542,13.1,12.7193,13.0094,12.0537,12.2801,13.2862,13.182,11.9256,13.0985,11.9415,13.417,13.1644,12.7278,12.1787,13.855,13.9543,12.0303,13.6224,11.9288,13.6531,2.90821,2.83704,2.93086,2.85611,2.85903,3.10096,12.5294,11.9409,13.5288,11.9806,8.25646,10.71133,10.45102,10.95524,13.367,13.3974,12.5844,12.559,12.7826,13.417,11.6093,13.0009,12.7158,12.8061,12.7458,13.3504,11.6077,11.8185,12.7348,12.0414,13.5495,12.2574,12.5025,11.6332,13.0236,12.3031,12.4834,12.5148,12.9036,13.1411,12.1024,11.9095,11.7948,13.237,12.9152,11.9277,11.9749,13.193,2.92585,2.87274,2.85662,2.85645,2.94404,13.6316,12.613,11.791,13.5107,11.9903,11.7958,12.78225,7.55114,6.95759,10.17594,13.54717,12.6281,12.7396,13.0839,12.8053,11.9095,13.9846,11.9272,12.8391,12.1715,12.0805,12.5594,13.0719,11.9317,13.3504,11.9112,13.7941,12.9396,11.812,13.6023,13.9249,13.0934,13.2463,11.7787,11.9256,12.5141,3.0293,3.02442,2.85672,2.9361,12.1254,11.928,12.238,12.555,11.9724,11.795,7.21848,9.11676,8.97034,8.40441,8.5215,10.68014,9.48923,9.11274,13.3008,12.2801,12.0537,12.6184,12.0869,12.2845,13.6086,12.5618,13.4025,12.7578,12.697,13.4936,12.3035,12.8553,11.7049,13.0241,13.8909,11.9048,12.5755,12.4458,12.6346,12.5755,11.9542,12.8449,13.1411,11.9903,12.6727,11.595,11.9095],null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null]},{"method":"addGeoJSON","args":["{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"color\":\"blue\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[1,40],[1,60],[14,60],[14,40],[1,40]]]}}]}",null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false}]}],"limits":{"lat":[48.79044,59.9413],"lng":[2.83178,13.9846]}},"evals":[],"jsHooks":[]}</script>
<!--/html_preserve-->
Points within a polygon
-----------------------

    body <- '{
     "query":{
       "bool" : {
         "must" : {
           "match_all" : {}
         },
         "filter":{
            "geo_polygon" : {
              "location" : {
                 "points" : [
                   [ 0, 55 ], [ 13, 56 ], [ 17, 50 ], [ 7, 42 ], [ 0, 55 ]
                 ]
               }
             }
           }
         }
       }
    }'
    out <- Search('gbifgeopoint', body = body, size = 500)
    out$hits$total

    #> [1] 76

    (dat <- make_df(out))

    #> # A tibble: 76 x 2
    #>        lon      lat
    #> *    <dbl>    <dbl>
    #> 1  2.97260 51.13451
    #> 2  2.93852 51.08603
    #> 3  2.93760 51.08666
    #> 4  2.85835 51.02540
    #> 5  2.94271 51.08526
    #> 6  2.93141 51.23301
    #> 7  2.93012 51.23349
    #> 8  7.15663 50.57702
    #> 9  8.96661 50.40650
    #> 10 6.74515 51.18375
    #> # ... with 66 more rows

visualize

    bounds <- '{"type":"FeatureCollection","features":[{"type":"Feature","properties":{"color":"blue"},"geometry":{"type":"Polygon","coordinates":[[[0,55],[13,56],[17,50],[7,42],[0,55]]]}}]}'
    make_viz(dat) %>% addGeoJSON(geojson = bounds)

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-4203">{"x":{"calls":[{"method":"addProviderTiles","args":["Stamen.Toner",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addMarkers","args":[[51.13451,51.08603,51.08666,51.0254,51.08526,51.23301,51.23349,50.57702,50.4065,51.18375,50.33438,50.85697,48.94891,55.7283,55.5458,55.6324,55.3757,51.21396,51.21672,51.21409,50.36873,51.19674,50.98989,55.6724,55.6073,55.5458,50.323,50.55233,49.37392,50.30291,49.01533,52.55914,49.3508,55.6106,51.15793,51.16502,51.23329,51.02456,51.0255,51.13017,49.79703,53.62209,51.91853,49.49161,55.3933,55.8968,55.5597,55.5333,51.15274,51.21639,51.02467,51.02468,51.08376,53.16262,51.62402,50.72377,52.45855,52.54577,55.8546,55.9058,55.6541,55.4044,51.22471,50.36614,51.0246,51.08631,51.62494,50.37828,50.40632,49.01533,49.43728,53.89132,48.79044,50.28015,55.4175,55.7311],[2.9726,2.93852,2.9376,2.85835,2.94271,2.93141,2.93012,7.15663,8.96661,6.74515,8.53929,6.14764,9.29086,13.1549,13.0966,13.0502,13.0979,2.87053,2.87409,2.86805,3.02608,2.83178,2.8549,13.0764,12.9768,13.0966,8.56359,8.83969,7.04092,8.62292,8.40441,13.54983,8.63868,13.0094,2.90821,2.83704,2.93086,2.85611,2.85903,3.10096,8.25646,10.71133,10.45102,10.95524,13.0009,12.8061,12.9036,13.193,2.92585,2.87274,2.85662,2.85645,2.94404,12.78225,7.55114,6.95759,10.17594,13.54717,13.0839,12.8053,13.0719,12.9396,3.0293,3.02442,2.85672,2.9361,7.21848,9.11676,8.97034,8.40441,8.5215,10.68014,9.48923,9.11274,12.8553,13.0241],null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null]},{"method":"addGeoJSON","args":["{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"color\":\"blue\"},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[0,55],[13,56],[17,50],[7,42],[0,55]]]}}]}",null,null,{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"dashArray":null,"smoothFactor":1,"noClip":false}]}],"limits":{"lat":[48.79044,55.9058],"lng":[2.83178,13.54983]}},"evals":[],"jsHooks":[]}</script>
<!--/html_preserve-->
